# SPDX-FileCopyrightText: Copyright (c) 2025 Objectionary.com
# SPDX-License-Identifier: MIT
diff --git a/node_modules/grunt-mocha-cli/lib/index.js b/node_modules/grunt-mocha-cli/lib/index.js
index 59f7a07..3ceaf4c 100644
--- a/node_modules/grunt-mocha-cli/lib/index.js
+++ b/node_modules/grunt-mocha-cli/lib/index.js
@@ -2,6 +2,7 @@
 const fs = require('fs')
 const path = require('path')
 const grunt = require('grunt')
+const os = require('os')
 
 const BOOL_OPTIONS = [
   'allow-uncaught',
@@ -40,7 +41,7 @@ const STRING_OPTIONS = [
   'timeout',
   'ui'
 ]
-const ARRAY_OPTIONS = ['globals']
+const ARRAY_OPTIONS = ['globals', 'node-option']
 
 module.exports = function(options) {
   return new Promise((resolve, reject) => {
@@ -51,12 +52,25 @@ module.exports = function(options) {
       }
     }
 
-    spawnOptions.cmd = require.resolve('mocha')
-    spawnOptions.cmd = path.dirname(spawnOptions.cmd)
-    spawnOptions.cmd += '/../.bin/mocha'
+    const mochaBinPath = require.resolve('mocha')
+    const mochaBinDir = path.dirname(mochaBinPath)
+    let mochaBin = mochaBinDir + '/../.bin/mocha'
 
     if (process.platform === 'win32') {
-      spawnOptions.cmd += '.cmd'
+      mochaBin += '.cmd'
+    }
+
+    if (os.platform() === 'win32') {
+      spawnOptions.opts.shell = true
+    }
+
+    // If node-option is provided, use node directly to run mocha
+    if (options['node-option'] && options['node-option'].length > 0) {
+      spawnOptions.cmd = process.execPath
+      args.unshift(mochaBin)
+      args.unshift(...options['node-option'])
+    } else {
+      spawnOptions.cmd = mochaBin
     }
 
     if (!options.quiet && !options.save) {
